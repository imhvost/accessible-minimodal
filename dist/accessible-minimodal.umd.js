/*!
* accessible-minimodal v2.2.1
* https://github.com/imhvost/accessible-minimodal
*/
if(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).AccessibleMinimodal={})}(this,(function(e){"use strict";const t={animationDuration:400,classes:{modal:"modal",wrapp:"modal-wrapp",body:"modal-body",active:"active",open:"open",close:"close"},disableScroll:{use:!0,jumpingElements:""},focus:{use:!0,selectors:["button:not([disabled])","a[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])",'[tabindex]:not([tabindex="-1"])','[contenteditable="true"]']},hash:{open:!1,add:!1,remove:!1},multiple:{use:!1,closePrevModal:!1},on:{beforeOpen:()=>({}),afterOpen:()=>({}),beforeClose:()=>({}),afterClose:()=>({})},outsideClose:!0,style:{use:!1,width:400,valign:"center",animation:"from-bottom"},triggersAttrs:{open:"data-modal-open",close:"data-modal-close",closeAll:"data-modal-close-all"}};e.AccessibleMinimodal=class{config;modal;openBtn;modals;focusBtns;animated;constructor(e={}){for(const[t,o]of Object.entries(e)){const n=t;if(void 0!==o){if("object"==typeof o){const t={...o};for(const[e,o]of Object.entries(t)){void 0===o&&delete t[e]}e[n]={...t}}}else delete e[n]}this.config=Object.assign({},t,e),Object.keys(e).map((o=>{const n=o;"object"==typeof e[n]&&(this.config[n]=Object.assign({},t[n],e[n]))})),this.modal=null,this.openBtn=null,this.modals=[],this.focusBtns=[],this.animated=!1,this.init(),this.addTriggers()}init(){if(this.config.style?.use&&this.addStyles(),this.config.hash?.open){const e=window.location.hash.substring(1)??"";e&&(this.modal=document.getElementById(e),this.openModal())}}addTriggers(){document.addEventListener("click",(e=>{const t=t=>{const o=e.target;return o.getAttribute(t)?o:o.closest(`[${t}]`)},o=t(this.config.triggersAttrs?.open??"");if(o&&(e.preventDefault(),this.modal=document.getElementById(o.getAttribute(this.config.triggersAttrs?.open??"")??""),this.openBtn=o,this.focusBtns.push(this.openBtn),this.openModal()),t(this.config.triggersAttrs?.close??"")&&(e.preventDefault(),this.closeModal()),t(this.config.triggersAttrs?.closeAll??"")&&(e.preventDefault(),this.closeAllModals()),this.config.outsideClose){const t=e.target;this.modal&&t.classList.contains(this.config.classes?.wrapp??"")&&!document?.activeElement?.closest("."+this.config.classes?.body)&&(e.preventDefault(),this.closeModal(this.modal))}}))}getOnInstance(){return{modal:this.modal,openBtn:this.openBtn,config:this.config}}openModal(e){this._openModal(e)}_openModal(e,t=!0){if(this.animated)return;if(e&&(this.modal="string"==typeof e?document.querySelector(e):e,t&&this.focusBtns.push(null)),!this.modal)return console.warn("AccessibleMinimodal warn: Modal HTMLElement not found"),void(this.animated=!1);let o=0;this.config.multiple?.use?(this.modals.length&&document.removeEventListener("keydown",this.onKeydown),this.config.multiple.closePrevModal&&this.modals.length&&(this._closeModal(this.modals[this.modals.length-1],!1),t&&(o=this.config.animationDuration??0))):this.modals.length&&(this.closeModal(this.modals[this.modals.length-1]),t&&(o=this.config.animationDuration??0)),setTimeout((()=>{if(this.animated=!0,this.config.on?.beforeOpen&&(this.config.on.beforeOpen(this.getOnInstance()),this.modal?.dispatchEvent(new Event("accessible-minimodal:before-open"))),this.modal?.classList.add(this.config.classes?.open??""),this.config.disableScroll?.use&&!this.modals.length){const e=this.getScrollbarWidth(),t=document.querySelector("html"),o=document.querySelector("body");if(t.style.overflow="hidden",o.style.overflow="hidden",e){t.style.paddingInlineEnd=`${e}px`;const{jumpingElements:o}=this.config.disableScroll;o&&(Array.isArray(o)&&o.length?o.forEach((t=>t.style.marginInlineEnd=`${e}px`)):"string"==typeof o&&document.querySelectorAll(o).forEach((t=>t.style.marginInlineEnd=`${e}px`)))}}this.modal&&this.modals.push(this.modal),this.config.hash?.add&&this.modal?.id&&window.history.replaceState("",location.href,"#"+this.modal.id),this.modal?.classList.add(this.config.classes?.active??""),this.modal?.setAttribute("aria-hidden","false"),setTimeout((()=>{if(this.modal?.classList.remove(this.config.classes?.open??""),this.animated=!1,this.config.focus?.use&&this.config.focus.selectors){const e=this.modal?.querySelectorAll(this.config.focus.selectors.join(", "));if(e){let t=e[0];t&&t.hasAttribute(this.config.triggersAttrs?.close??"")&&e.length>1&&(t=e[1]),t&&t.focus()}}document.addEventListener("keydown",this.onKeydown.bind(this)),this.config.on?.afterOpen&&(this.config.on.afterOpen(this.getOnInstance()),this.modal?.dispatchEvent(new Event("accessible-minimodal:after-open")))}),this.config.animationDuration)}),o)}closeModal(e){this._closeModal(e)}_closeModal(e,t=!0,o=!1){if(this.animated&&!o)return;this.animated=!0;let n=null;if(e?n="string"==typeof e?document.querySelector(e):e:this.modal&&(n=this.modal),!n)return void(this.animated=!1);const s=this.modals.findIndex((e=>e.isSameNode(n)));t&&this.modals.splice(s,1),this.config.on?.beforeClose&&(this.config.on.beforeClose(this.getOnInstance()),this.modal?.dispatchEvent(new Event("accessible-minimodal:before-close"))),n.classList.add(this.config.classes?.close??""),n.classList.remove(this.config.classes?.active??""),n.setAttribute("aria-hidden","true"),document.removeEventListener("keydown",this.onKeydown),this.config.hash?.remove&&window.history.replaceState("",location.href,location.pathname+location.search),setTimeout((()=>{if(n?.classList.remove(this.config.classes?.close??""),this.config.on?.afterClose&&(this.config.on.afterClose(this.getOnInstance()),this.modal?.dispatchEvent(new Event("accessible-minimodal:after-close"))),this.config.multiple?.use&&t?this.modals.length?this.modal=this.modals[this.modals.length-1]:this.modal=null:n?.isSameNode(this.modal)&&(this.modal=null),this.animated=!1,this.config.multiple?.use&&this.config.multiple?.closePrevModal&&t&&!o&&this.modals.length&&this._openModal(this.modals.pop(),!1),this.config.focus?.use&&this.focusBtns.length)if(o){const e=this.focusBtns.find((e=>null!==e));e&&(e.focus(),this.focusBtns=[])}else{const e=this.focusBtns[s];e&&(e.focus(),t&&this.focusBtns.splice(s,1))}if(this.config.disableScroll?.use&&!this.modals.length){const e=document.querySelector("html"),t=document.querySelector("body");e.style.removeProperty("overflow"),e.style.removeProperty("padding-inline-end"),t.style.removeProperty("overflow");const{jumpingElements:o}=this.config.disableScroll;o&&(Array.isArray(o)&&o.length?o.forEach((e=>e.style.removeProperty("margin-inline-end"))):"string"==typeof o&&document.querySelectorAll(o).forEach((e=>e.style.removeProperty("margin-inline-end"))))}}),this.config.animationDuration)}closeAllModals(){this.modals.length&&this.modals.forEach((e=>{console.log(e),this._closeModal(e,!1,!0),this.modals=[]}))}getScrollbarWidth(){return window.screen.width-document.documentElement.clientWidth==0?0:window.innerWidth-document.documentElement.clientWidth}onKeydown(e){this.modal&&("Escape"===e.key&&this.closeModal(this.modal),"Tab"===e.key&&this.changeFocus(e))}changeFocus(e){if(!this.config.focus?.selectors)return;const t=this.modal?.querySelectorAll(this.config.focus.selectors.join(", "));if(!t)return;const o=t[0],n=t[t.length-1],s=e.target;e.shiftKey?s.isEqualNode(o)&&(n.focus(),e.preventDefault()):s.isEqualNode(n)&&(o.focus(),e.preventDefault())}addStyles(){const e={...this.config.classes},t=this.config.animationDuration+"ms",o=`[${this.config.triggersAttrs?.close}]`,n=(e=>{const{modal:t,wrapp:o,body:n,active:s,open:i,close:a}=e.classNames,l="--accessible-minimodal",c=(e=>{switch(e){case"top":return"0 auto auto";case"bottom":return"auto auto 0";default:return"auto"}})(e.margin??""),r=(e=>{switch(e){case"from-top":return`translateY( calc(var(${l}-translate) * -1) )`;case"from-left":return`translateX( calc(var(${l}-translate) * -1) )`;case"from-right":return`translateX(var(${l}-translate))`;case"zoom-in":return"scale(.8)";case"zoom-out":return"scale(1.2)";case"fade":return"none";default:return`translateY(var(${l}-translate))`}})(e.transform??"");return`\n:root{\n${l}-color: #333;\n${l}-bg: #fff;\n${l}-filter: rgba(0, 0, 0, .7);\n${l}-z-index: 666666;\n${l}-padding: 40px;\n${l}-border-radius: 4px;\n${l}-translate: 20px;\n${l}-scale-in: .8;\n${l}-scale-out: 1.2;\n}\n.${t} {\n  position: fixed;\n  inset: 0;\n  z-index: var(${l}-z-index);\n}\n.${t}:not(.${s}) {\n  opacity: 0;\n  visibility: hidden;\n  pointer-events: none;\n}\n.${t}.${i},\n.${t}.${a} {\n  transition: opacity ${e.animationDuration}, visibility ${e.animationDuration};\n}\n.${t}.open .${n},\n.${t}.close .${n} {\n  transition: transform ${e.animationDuration};\n}\n.${t}.${s} .${n} {\n  transform: none;\n}\n.${o} {\n  height: 100%;\n  display: flex;\n  background-color: var(${l}-filter);\n  padding: var(${l}-padding) calc(${l}-padding / 2);\n  overflow-y: scroll;\n}\n.${n} {\n  background-color: var(${l}-bg);\n  color: var(${l}-color);\n  flex: none;\n  min-height: 0;\n  border-radius: var(${l}-border-radius);\n  width: ${e.width}px;\n  max-width: 100%;\n  margin: ${c};\n  padding: var(${l}-padding);\n  transform: ${r};\n  position: relative;\n}\n.${n} > ${e.closeSelector} {\n  position: absolute;\n  right: calc(var(${l}-padding) / 4);\n  top: calc(var(${l}-padding) / 4);\n  width: calc(var(${l}-padding) / 2);\n  height: calc(var(${l}-padding) / 2);\n  border: 0;\n  background: none;\n  cursor: pointer;\n  font-size: 0;\n}\n.${n} > ${e.closeSelector}:before,\n.${n} > ${e.closeSelector}:after {\n  content: '';\n  position: absolute;\n  width: 16px;\n  inset: 50% 0 auto 50%;\n  margin: -1px 0 0 -8px;\n  background-color: currentColor;\n  height: 2px;\n}\n.${n} > ${e.closeSelector}:before {\n  transform: rotate(45deg);\n}\n.${n} ${e.closeSelector}:after {\n  transform: rotate(-45deg);\n}\n`.replace(/\s*([:;,{}])\s*/g,"$1")})({classNames:e,animationDuration:t,margin:this.config.style?.valign,transform:this.config.style?.animation,closeSelector:o,width:this.config.style?.width});document.head.insertAdjacentHTML("beforeend",`<style>${n}</style>`),document.querySelectorAll("."+this.config.classes?.modal).forEach((e=>{e.style.removeProperty("display")}))}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})),globalThis.AccessibleMinimodal)for(const e of Object.keys(globalThis.AccessibleMinimodal))globalThis[e]=globalThis.AccessibleMinimodal[e];
