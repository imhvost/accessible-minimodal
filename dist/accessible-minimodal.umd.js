/*!
* accessible-minimodal v2.6.5
* https://github.com/imhvost/accessible-minimodal
*/
if(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).AccessibleMinimodal={})}(this,(function(e){"use strict";const t={animationDuration:400,classes:{modal:"modal",wrapp:"modal-wrapp",body:"modal-body",closeBtn:"modal-close-btn",active:"active",open:"open",close:"close"},disableScroll:{use:!0,jumpingElements:""},focus:{use:!0,selectors:["button:not([disabled])","a[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])",'[tabindex]:not([tabindex="-1"])','[contenteditable="true"]']},hash:{open:!1,add:!1,remove:!1},multiple:{use:!1,closePrevModal:!1},on:{beforeOpen:void 0,afterOpen:void 0,beforeClose:void 0,afterClose:void 0},outsideClose:!0,style:{use:!1,width:400,valign:"center",animation:"from-bottom"},triggers:{use:!0,open:"data-modal-open",close:"data-modal-close",closeAll:"data-modal-close-all"}};e.AccessibleMinimodal=class{config;modal;openBtn;modals;focusBtns;animated;constructor(e={}){for(const[t,n]of Object.entries(e)){const o=t;if(void 0!==n){if("object"==typeof n){const t={...n};for(const[e,n]of Object.entries(t)){void 0===n&&delete t[e]}e[o]={...t}}}else delete e[o]}this.config=Object.assign({},t,e),Object.keys(e).map((n=>{const o=n;"object"==typeof e[o]&&(this.config[o]=Object.assign({},t[o],e[o]))})),this.modal=null,this.openBtn=null,this.modals=[],this.focusBtns=[],this.animated=!1,this.init()}init(){if(this.config.triggers?.use&&this.addTriggers(),this.config.style?.use&&this.addStyles(),this.config.hash?.open){const e=window.location.hash.substring(1)??"";e&&(this.modal=document.getElementById(e),this.openModal())}}addTriggers(e){e=e||this.config.triggers,document.addEventListener("click",(t=>{const n=e=>{if(!e)return null;const n=t.target;return n.getAttribute(e)?n:n.closest(`[${e}]`)},o=n(e?.open??"");if(o&&(t.preventDefault(),this.modal=document.getElementById(o.getAttribute(e?.open??"")??""),this.openBtn=o,this.focusBtns.push(this.openBtn),this.openModal()),n(e?.close??"")&&(t.preventDefault(),this.closeModal()),n(e?.closeAll??"")&&(t.preventDefault(),this.closeAllModals()),this.config.outsideClose){const e=t.target;this.modal&&e.classList.contains(this.config.classes?.wrapp??"")&&!document?.activeElement?.closest("."+this.config.classes?.body)&&(t.preventDefault(),this.closeModal(this.modal))}}))}getOnInstance(){return{modal:this.modal,openBtn:this.openBtn}}openModal(e){this._openModal(e)}_openModal(e,t=!0){if(this.animated)return;if(e&&(this.modal="string"==typeof e?document.getElementById(e):e,t&&this.focusBtns.push(null)),!this.modal)return void console.warn("AccessibleMinimodal warn: Modal HTMLElement not found");const n=this.modal?.dispatchEvent(new Event("accessible-minimodal:before-open",{cancelable:!0}));if(!n)return;this.animated=!0,this.config.on?.beforeOpen&&this.config.on.beforeOpen(this.getOnInstance());let o=0;this.config.multiple?.use?(this.modals.length&&document.removeEventListener("keydown",this.onKeydown),this.config.multiple.closePrevModal&&this.modals.length&&(this._closeModal(this.modals[this.modals.length-1],!1),t&&(o=this.config.animationDuration??0))):this.modals.length&&(this.closeModal(this.modals[this.modals.length-1]),t&&(o=this.config.animationDuration??0)),setTimeout((()=>{if(this.modal?.classList.add(this.config.classes?.open??""),this.config.disableScroll?.use&&!this.modals.length){const e=this.getScrollbarWidth(),t=document.querySelector("html"),n=document.querySelector("body");if(t.style.overflow="hidden",n.style.overflow="hidden",e){t.style.paddingInlineEnd=`${e}px`;const{jumpingElements:n}=this.config.disableScroll;n&&(Array.isArray(n)&&n.length?n.forEach((t=>t.style.marginInlineEnd=`${e}px`)):"string"==typeof n&&document.querySelectorAll(n).forEach((t=>t.style.marginInlineEnd=`${e}px`)))}}this.modal&&this.modals.push(this.modal),this.config.hash?.add&&this.modal?.id&&window.history.replaceState("",location.href,"#"+this.modal.id),this.modal?.classList.add(this.config.classes?.active??""),setTimeout((()=>{if(this.modal?.classList.remove(this.config.classes?.open??""),this.animated=!1,this.config.focus?.use&&this.config.focus.selectors){const e=this.modal?.querySelectorAll(this.config.focus.selectors.join(", "));if(e){let t=e[0];t&&t.hasAttribute(this.config.triggers?.close??"")&&e.length>1&&(t=e[1]),t&&t.focus()}}document.addEventListener("keydown",this.onKeydown.bind(this)),this.modal?.dispatchEvent(new Event("accessible-minimodal:after-open")),this.config.on?.afterOpen&&this.config.on.afterOpen(this.getOnInstance())}),this.config.animationDuration)}),o)}closeModal(e){this._closeModal(e)}_closeModal(e,t=!0,n=!1){if(this.animated)return;let o=null;if(e?o="string"==typeof e?document.getElementById(e):e:this.modal&&(o=this.modal),!o)return;const s=this.modal?.dispatchEvent(new Event("accessible-minimodal:before-close",{cancelable:!0}));if(!s)return;this.animated=!0,this.config.on?.beforeClose&&this.config.on.beforeClose(this.getOnInstance());const i=this.modals.findIndex((e=>e.isSameNode(o)));t&&!n&&this.modals.splice(i,1),o.classList.add(this.config.classes?.close??""),o.classList.remove(this.config.classes?.active??""),document.removeEventListener("keydown",this.onKeydown),this.config.hash?.remove&&window.history.replaceState("",location.href,location.pathname+location.search),setTimeout((()=>{if(o?.classList.remove(this.config.classes?.close??""),this.modal?.dispatchEvent(new Event("accessible-minimodal:after-close")),this.config.on?.afterClose&&this.config.on.afterClose(this.getOnInstance()),this.config.multiple?.use&&t?this.modals.length?(n&&this.modals.pop(),this.modal=this.modals[this.modals.length-1]):this.modal=null:o?.isSameNode(this.modal)&&(this.modal=null),this.animated=!1,this.config.multiple?.use&&this.config.multiple?.closePrevModal&&t&&!n&&this.modals.length&&this._openModal(this.modals.pop(),!1),this.focusBtns.length)if(n){const e=this.focusBtns.find((e=>null!==e));e&&e.focus()}else{const e=this.focusBtns[i];e&&(e.focus(),t&&this.focusBtns.splice(i,1))}if(this.config.disableScroll?.use&&!this.modals.length){const e=document.querySelector("html"),t=document.querySelector("body");e.style.removeProperty("overflow"),e.style.removeProperty("padding-inline-end"),t.style.removeProperty("overflow");const{jumpingElements:n}=this.config.disableScroll;n&&(Array.isArray(n)&&n.length?n.forEach((e=>e.style.removeProperty("margin-inline-end"))):"string"==typeof n&&document.querySelectorAll(n).forEach((e=>e.style.removeProperty("margin-inline-end"))))}n&&(this.focusBtns=[],this.modals=[],this.modal=null)}),this.config.animationDuration)}closeAllModals(){this.modals.length&&this.modals.forEach((e=>{this._closeModal(e,!0,!0)}))}getScrollbarWidth(){return window.screen.width-document.documentElement.clientWidth==0?0:window.innerWidth-document.documentElement.clientWidth}onKeydown(e){this.modal&&("Escape"===e.key&&this.closeModal(this.modal),"Tab"===e.key&&this.changeFocus(e))}changeFocus(e){if(!this.config.focus?.selectors)return;const t=this.modal?.querySelectorAll(this.config.focus.selectors.join(", "));if(!t)return;const n=t[0],o=t[t.length-1],s=e.target;e.shiftKey?s.isEqualNode(n)&&(o.focus(),e.preventDefault()):s.isEqualNode(o)&&(n.focus(),e.preventDefault())}addStyles(){const e=(e=>{const{modal:t,wrapp:n,body:o,closeBtn:s,active:i,open:a,close:l}=e.classNames,c="--accessible-minimodal",r=(e=>{switch(e){case"top":return"0 auto auto";case"bottom":return"auto auto 0";default:return"auto"}})(e.margin??""),d=(e=>{switch(e){case"from-top":return`translateY( calc(var(${c}-translate) * -1) )`;case"from-left":return`translateX( calc(var(${c}-translate) * -1) )`;case"from-right":return`translateX(var(${c}-translate))`;case"zoom-in":return"scale(.8)";case"zoom-out":return"scale(1.2)";case"fade":return"none";default:return`translateY(var(${c}-translate))`}})(e.transform??"");return`\n:root{\n${c}-color: #333;\n${c}-bg: #fff;\n${c}-filter: rgba(0, 0, 0, .7);\n${c}-z-index: 666666;\n${c}-padding: 40px;\n${c}-border-radius: 4px;\n${c}-translate: 20px;\n${c}-scale-in: .8;\n${c}-scale-out: 1.2;\n}\n.${t} {\n  position: fixed;\n  inset: 0;\n  z-index: var(${c}-z-index);\n  transition-property: opacity, visibility;\n}\n.${t}:not(.${i}) {\n  opacity: 0;\n  visibility: hidden;\n  pointer-events: none;\n}\n.${t}.${a},\n.${t}.${l} {\n  transition-duration: ${e.animationDuration};\n}\n.${t}.${i} .${o} {\n  transform: none;\n}\n.${n} {\n  height: 100%;\n  display: flex;\n  background-color: var(${c}-filter);\n  padding: var(${c}-padding) calc(var(${c}-padding) / 2);\n  overflow-y: scroll;\n}\n.${o} {\n  background-color: var(${c}-bg);\n  color: var(${c}-color);\n  flex: none;\n  min-height: 0;\n  border-radius: var(${c}-border-radius);\n  width: ${e.width}px;\n  max-width: 100%;\n  margin: ${r};\n  padding: var(${c}-padding);\n  transform: ${d};\n  position: relative;\n  transition-duration: ${e.animationDuration};\n  transition-property: transform;\n}\n.${s} {\n  position: absolute;\n  right: calc(var(${c}-padding) / 4);\n  top: calc(var(${c}-padding) / 4);\n  width: calc(var(${c}-padding) / 2);\n  height: calc(var(${c}-padding) / 2);\n  border: 0;\n  background: none;\n  cursor: pointer;\n  font-size: 0;\n}\n.${s}:before,\n.${s}:after {\n  content: '';\n  position: absolute;\n  width: 16px;\n  inset: 50% 0 auto 50%;\n  margin: -1px 0 0 -8px;\n  background-color: currentColor;\n  height: 2px;\n}\n.${s}:before {\n  transform: rotate(45deg);\n}\n.${s}:after {\n  transform: rotate(-45deg);\n}\n`.replace(/\s*([:;,{}])\s*/g,"$1")})({classNames:{...this.config.classes},animationDuration:this.config.animationDuration+"ms",margin:this.config.style?.valign,transform:this.config.style?.animation,width:this.config.style?.width});document.head.insertAdjacentHTML("beforeend",`<style>${e}</style>`),document.querySelectorAll("."+this.config.classes?.modal).forEach((e=>{e.style.removeProperty("display")}))}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})),globalThis.AccessibleMinimodal)for(const e of Object.keys(globalThis.AccessibleMinimodal))globalThis[e]=globalThis.AccessibleMinimodal[e];
